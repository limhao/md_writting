---
title: 定时器（1）
---

9/23 今天学到的第二个知识

功能最强大 结构最复杂的外设

4部分8小节

1. 定时器基本功能 在定时内每隔一个时间产生一个中断
2. 定时器输出比较的功能，产生PWM波形驱动电机
3. 定时器输入捕获，来测量方波频率
4. 定时器编码器接口

![](https://pic.imgdb.cn/item/650e984ac458853aef044f47.jpg)

72M/65536/65536 在取倒数

## 定时器类型

![](https://pic.imgdb.cn/item/650e984ac458853aef044f56.jpg)

![](https://pic.imgdb.cn/item/650e984ac458853aef044f63.jpg)

- 基本定时器

内部时钟 72M

PSC预分频器会对频率进行分频

其中分频数为 设定值+1

eg 假如设定为0 则不会对频率进行分频 将继续由72M进行计数

CNT 根据频率进行计数

自动重装载寄存器 当CNT计数的值于自动重装载寄存器的值相同时

会产生一个更新中断和更新事件

会自动重载cnt 记的数字 

- 通用定时器

支持 向上 向下 中央对其 三种计数模式

## 时序分析

![](https://pic.imgdb.cn/item/650e984ac458853aef044f82.jpg)

预分频控制寄存器（影子寄存器）与预分频缓冲器（真正工作的寄存器）

在预分频控制寄存器存下针对于分频的更新 会将更新值保存下 在更新事件触发时 更新分频频率

![](https://pic.imgdb.cn/item/650e984ac458853aef044f6f.jpg)

